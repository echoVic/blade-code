# Git å·¥å…·æ–‡æ¡£

Agent CLI ç°åœ¨åŒ…å«äº†ä¸€å¥—å®Œæ•´çš„ Git å·¥å…·ï¼Œæ”¯æŒå¸¸è§çš„ Git æ“ä½œã€‚

## å·¥å…·åˆ—è¡¨

### 1. git_status - Git ä»“åº“çŠ¶æ€æŸ¥çœ‹
æŸ¥çœ‹ Git ä»“åº“çš„å½“å‰çŠ¶æ€ï¼ŒåŒ…æ‹¬æœªè·Ÿè¸ªæ–‡ä»¶ã€å·²ä¿®æ”¹æ–‡ä»¶å’Œæš‚å­˜åŒºçŠ¶æ€ã€‚

**å‚æ•°ï¼š**
- `path` (å¯é€‰): ä»“åº“è·¯å¾„ï¼Œé»˜è®¤ä¸ºå½“å‰ç›®å½•
- `porcelain` (å¯é€‰): ä½¿ç”¨æœºå™¨å¯è¯»æ ¼å¼
- `short` (å¯é€‰): æ˜¾ç¤ºç®€çŸ­æ ¼å¼

**ç¤ºä¾‹ï¼š**
```bash
# æŸ¥çœ‹å½“å‰ä»“åº“çŠ¶æ€
agent tools call git_status

# æŸ¥çœ‹ç®€çŸ­æ ¼å¼çŠ¶æ€
agent tools call git_status --params '{"short": true}'

# æŸ¥çœ‹æœºå™¨å¯è¯»æ ¼å¼çŠ¶æ€  
agent tools call git_status --params '{"porcelain": true}'
```

### 2. git_log - Git æäº¤å†å²æŸ¥çœ‹
æŸ¥çœ‹ Git æäº¤å†å²è®°å½•ã€‚

**å‚æ•°ï¼š**
- `path` (å¯é€‰): ä»“åº“è·¯å¾„ï¼Œé»˜è®¤ä¸ºå½“å‰ç›®å½•
- `limit` (å¯é€‰): æ˜¾ç¤ºçš„æäº¤æ•°é‡é™åˆ¶ï¼Œé»˜è®¤10
- `oneline` (å¯é€‰): æ¯ä¸ªæäº¤æ˜¾ç¤ºä¸€è¡Œ
- `graph` (å¯é€‰): æ˜¾ç¤ºåˆ†æ”¯å›¾å½¢
- `author` (å¯é€‰): æŒ‰ä½œè€…è¿‡æ»¤æäº¤
- `since` (å¯é€‰): æ˜¾ç¤ºæŒ‡å®šæ—¥æœŸä¹‹åçš„æäº¤
- `until` (å¯é€‰): æ˜¾ç¤ºæŒ‡å®šæ—¥æœŸä¹‹å‰çš„æäº¤

**ç¤ºä¾‹ï¼š**
```bash
# æŸ¥çœ‹æœ€è¿‘10ä¸ªæäº¤
agent tools call git_log

# æŸ¥çœ‹æœ€è¿‘5ä¸ªæäº¤çš„ç®€çŸ­è®°å½•
agent tools call git_log --params '{"limit": 5, "oneline": true}'

# æŸ¥çœ‹å¸¦åˆ†æ”¯å›¾çš„æäº¤å†å²
agent tools call git_log --params '{"graph": true, "limit": 5}'

# æŸ¥çœ‹ç‰¹å®šä½œè€…çš„æäº¤
agent tools call git_log --params '{"author": "å¼ ä¸‰", "limit": 10}'

# æŸ¥çœ‹æœ€è¿‘ä¸€å‘¨çš„æäº¤
agent tools call git_log --params '{"since": "1 week ago"}'
```

### 3. git_diff - Git æ–‡ä»¶å·®å¼‚æŸ¥çœ‹
æŸ¥çœ‹æ–‡ä»¶å·®å¼‚å’Œæ›´æ”¹å†…å®¹ã€‚

**å‚æ•°ï¼š**
- `path` (å¯é€‰): ä»“åº“è·¯å¾„ï¼Œé»˜è®¤ä¸ºå½“å‰ç›®å½•
- `file` (å¯é€‰): æŒ‡å®šæ–‡ä»¶è·¯å¾„
- `staged` (å¯é€‰): æŸ¥çœ‹æš‚å­˜åŒºçš„å·®å¼‚
- `cached` (å¯é€‰): æŸ¥çœ‹å·²æš‚å­˜æ–‡ä»¶çš„å·®å¼‚ï¼ˆåŒstagedï¼‰
- `nameOnly` (å¯é€‰): åªæ˜¾ç¤ºæ–‡ä»¶å
- `stat` (å¯é€‰): æ˜¾ç¤ºç»Ÿè®¡ä¿¡æ¯
- `commit1` (å¯é€‰): ç¬¬ä¸€ä¸ªæäº¤hash/åˆ†æ”¯å
- `commit2` (å¯é€‰): ç¬¬äºŒä¸ªæäº¤hash/åˆ†æ”¯å

**ç¤ºä¾‹ï¼š**
```bash
# æŸ¥çœ‹å·¥ä½œåŒºä¸æš‚å­˜åŒºçš„å·®å¼‚
agent tools call git_diff

# æŸ¥çœ‹æš‚å­˜åŒºä¸æœ€åæäº¤çš„å·®å¼‚
agent tools call git_diff --params '{"staged": true}'

# åªæ˜¾ç¤ºæœ‰å·®å¼‚çš„æ–‡ä»¶å
agent tools call git_diff --params '{"nameOnly": true}'

# æ˜¾ç¤ºç»Ÿè®¡ä¿¡æ¯
agent tools call git_diff --params '{"stat": true}'

# æŸ¥çœ‹ç‰¹å®šæ–‡ä»¶çš„å·®å¼‚
agent tools call git_diff --params '{"file": "src/index.ts"}'

# æ¯”è¾ƒä¸¤ä¸ªæäº¤ä¹‹é—´çš„å·®å¼‚
agent tools call git_diff --params '{"commit1": "HEAD~1", "commit2": "HEAD"}'
```

### 4. git_branch - Git åˆ†æ”¯ç®¡ç†
ç®¡ç† Git åˆ†æ”¯ï¼ŒåŒ…æ‹¬åˆ—å‡ºã€åˆ›å»ºã€åˆ é™¤å’Œåˆ‡æ¢åˆ†æ”¯ã€‚

**å‚æ•°ï¼š**
- `path` (å¯é€‰): ä»“åº“è·¯å¾„ï¼Œé»˜è®¤ä¸ºå½“å‰ç›®å½•
- `action` (å¯é€‰): æ“ä½œç±»å‹ - list/create/delete/switchï¼Œé»˜è®¤list
- `branchName` (å¯é€‰): åˆ†æ”¯åç§°
- `remote` (å¯é€‰): åŒ…å«è¿œç¨‹åˆ†æ”¯
- `all` (å¯é€‰): æ˜¾ç¤ºæ‰€æœ‰åˆ†æ”¯ï¼ˆæœ¬åœ°å’Œè¿œç¨‹ï¼‰
- `createFrom` (å¯é€‰): ä»æŒ‡å®šåˆ†æ”¯åˆ›å»ºæ–°åˆ†æ”¯

**ç¤ºä¾‹ï¼š**
```bash
# åˆ—å‡ºæœ¬åœ°åˆ†æ”¯
agent tools call git_branch

# åˆ—å‡ºæ‰€æœ‰åˆ†æ”¯ï¼ˆåŒ…æ‹¬è¿œç¨‹ï¼‰
agent tools call git_branch --params '{"all": true}'

# åˆ›å»ºæ–°åˆ†æ”¯
agent tools call git_branch --params '{"action": "create", "branchName": "feature/new-feature"}'

# ä»æŒ‡å®šåˆ†æ”¯åˆ›å»ºæ–°åˆ†æ”¯
agent tools call git_branch --params '{"action": "create", "branchName": "hotfix/bug-fix", "createFrom": "main"}'

# åˆ‡æ¢åˆ†æ”¯
agent tools call git_branch --params '{"action": "switch", "branchName": "feature/new-feature"}'

# åˆ é™¤åˆ†æ”¯
agent tools call git_branch --params '{"action": "delete", "branchName": "old-feature"}'
```

### 5. git_add - Git æ–‡ä»¶æš‚å­˜
æ·»åŠ æ–‡ä»¶åˆ° Git æš‚å­˜åŒºã€‚

**å‚æ•°ï¼š**
- `path` (å¯é€‰): ä»“åº“è·¯å¾„ï¼Œé»˜è®¤ä¸ºå½“å‰ç›®å½•
- `files` (å¯é€‰): è¦æ·»åŠ çš„æ–‡ä»¶è·¯å¾„ï¼Œæ”¯æŒé€šé…ç¬¦ï¼Œç”¨ç©ºæ ¼åˆ†éš”å¤šä¸ªæ–‡ä»¶
- `all` (å¯é€‰): æ·»åŠ æ‰€æœ‰ä¿®æ”¹çš„æ–‡ä»¶
- `update` (å¯é€‰): åªæ·»åŠ å·²è·Ÿè¸ªçš„æ–‡ä»¶
- `dryRun` (å¯é€‰): å¹²è¿è¡Œï¼Œåªæ˜¾ç¤ºå°†è¦æ·»åŠ çš„æ–‡ä»¶

**ç¤ºä¾‹ï¼š**
```bash
# æ·»åŠ å½“å‰ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶
agent tools call git_add

# æ·»åŠ ç‰¹å®šæ–‡ä»¶
agent tools call git_add --params '{"files": "src/index.ts src/utils.ts"}'

# æ·»åŠ æ‰€æœ‰ä¿®æ”¹çš„æ–‡ä»¶
agent tools call git_add --params '{"all": true}'

# åªæ·»åŠ å·²è·Ÿè¸ªçš„æ–‡ä»¶
agent tools call git_add --params '{"update": true}'

# é¢„è§ˆå°†è¦æ·»åŠ çš„æ–‡ä»¶
agent tools call git_add --params '{"dryRun": true, "all": true}'
```

### 6. git_commit - Git æäº¤æ›´æ”¹
æäº¤æš‚å­˜åŒºçš„æ›´æ”¹ã€‚

**å‚æ•°ï¼š**
- `path` (å¯é€‰): ä»“åº“è·¯å¾„ï¼Œé»˜è®¤ä¸ºå½“å‰ç›®å½•
- `message` (å¿…éœ€): æäº¤ä¿¡æ¯
- `all` (å¯é€‰): è‡ªåŠ¨æš‚å­˜æ‰€æœ‰å·²è·Ÿè¸ªæ–‡ä»¶çš„æ›´æ”¹
- `amend` (å¯é€‰): ä¿®æ”¹æœ€åä¸€æ¬¡æäº¤
- `author` (å¯é€‰): æŒ‡å®šä½œè€… (æ ¼å¼: "Name <email>")
- `dryRun` (å¯é€‰): å¹²è¿è¡Œï¼Œåªæ˜¾ç¤ºå°†è¦æäº¤çš„å†…å®¹
- `allowEmpty` (å¯é€‰): å…è®¸ç©ºæäº¤

**ç¤ºä¾‹ï¼š**
```bash
# æäº¤æš‚å­˜åŒºçš„æ›´æ”¹
agent tools call git_commit --params '{"message": "feat: æ·»åŠ æ–°åŠŸèƒ½"}'

# è‡ªåŠ¨æš‚å­˜å¹¶æäº¤æ‰€æœ‰å·²è·Ÿè¸ªæ–‡ä»¶çš„æ›´æ”¹
agent tools call git_commit --params '{"message": "fix: ä¿®å¤bug", "all": true}'

# ä¿®æ”¹æœ€åä¸€æ¬¡æäº¤ä¿¡æ¯
agent tools call git_commit --params '{"message": "feat: æ·»åŠ æ–°åŠŸèƒ½ï¼ˆæ›´æ–°ï¼‰", "amend": true}'

# æŒ‡å®šä½œè€…æäº¤
agent tools call git_commit --params '{"message": "feat: æ–°åŠŸèƒ½", "author": "å¼ ä¸‰ <zhangsan@example.com>"}'

# é¢„è§ˆæäº¤
agent tools call git_commit --params '{"message": "feat: æ–°åŠŸèƒ½", "dryRun": true}'

# å…è®¸ç©ºæäº¤
agent tools call git_commit --params '{"message": "chore: è§¦å‘CI", "allowEmpty": true}'
```

### 7. git_smart_commit - Git æ™ºèƒ½æäº¤
ä½¿ç”¨LLMæ™ºèƒ½åˆ†æå˜æ›´å†…å®¹å¹¶ç”Ÿæˆåˆé€‚çš„æäº¤ä¿¡æ¯ï¼Œç„¶åæ‰§è¡Œæäº¤ã€‚

**å‚æ•°ï¼š**
- `path` (å¯é€‰): ä»“åº“è·¯å¾„ï¼Œé»˜è®¤ä¸ºå½“å‰ç›®å½•
- `autoAdd` (å¯é€‰): æ˜¯å¦è‡ªåŠ¨æ·»åŠ æ‰€æœ‰ä¿®æ”¹çš„æ–‡ä»¶åˆ°æš‚å­˜åŒºï¼Œé»˜è®¤true
- `dryRun` (å¯é€‰): å¹²è¿è¡Œï¼Œåªåˆ†æå¹¶ç”Ÿæˆæäº¤ä¿¡æ¯ï¼Œä¸å®é™…æäº¤
- `llmAnalysis` (å¯é€‰): LLMåˆ†æçš„å˜æ›´å†…å®¹ï¼ˆç”±Agentè‡ªåŠ¨å¡«å……ï¼‰

**ç¤ºä¾‹ï¼š**
```bash
# æ™ºèƒ½åˆ†æå¹¶æäº¤å½“å‰æ‰€æœ‰å˜æ›´
agent tools call git_smart_commit

# åªåˆ†æç”Ÿæˆæäº¤ä¿¡æ¯ï¼Œä¸å®é™…æäº¤
agent tools call git_smart_commit --params '{"dryRun": true}'

# ä¸è‡ªåŠ¨æ·»åŠ æ–‡ä»¶ï¼Œåªæäº¤å·²æš‚å­˜çš„å˜æ›´
agent tools call git_smart_commit --params '{"autoAdd": false}'
```

**æ™ºèƒ½ç‰¹æ€§ï¼š**
- ğŸ¤– **LLMåˆ†æ**ï¼šè‡ªåŠ¨åˆ†æå˜æ›´å†…å®¹ï¼Œç†è§£ä»£ç ä¿®æ”¹æ„å›¾
- ğŸ“ **è§„èŒƒæ ¼å¼**ï¼šç”Ÿæˆç¬¦åˆConventional Commitsè§„èŒƒçš„æäº¤ä¿¡æ¯
- ğŸ¯ **ç²¾å‡†æè¿°**ï¼šæ ¹æ®å®é™…å˜æ›´å†…å®¹ç”Ÿæˆå‡†ç¡®çš„æè¿°
- ğŸš€ **ä¸€é”®æäº¤**ï¼šè‡ªåŠ¨å®Œæˆæ·»åŠ ã€åˆ†æã€æäº¤çš„å®Œæ•´æµç¨‹

## æ™ºèƒ½åŠ©æ‰‹ä¸­çš„ä½¿ç”¨

ä½ ä¹Ÿå¯ä»¥åœ¨æ™ºèƒ½åŠ©æ‰‹èŠå¤©ä¸­ç›´æ¥è¯¢é—® Git ç›¸å…³é—®é¢˜ï¼ŒåŠ©æ‰‹ä¼šè‡ªåŠ¨é€‰æ‹©åˆé€‚çš„å·¥å…·æ¥å›ç­”ï¼š

```bash
# æŸ¥çœ‹ä»“åº“çŠ¶æ€
agent chat "æŸ¥çœ‹å½“å‰gitä»“åº“çš„çŠ¶æ€"

# æŸ¥çœ‹æäº¤å†å²
agent chat "æ˜¾ç¤ºæœ€è¿‘5ä¸ªæäº¤è®°å½•"

# æŸ¥çœ‹åˆ†æ”¯ä¿¡æ¯
agent chat "åˆ—å‡ºæ‰€æœ‰åˆ†æ”¯å¹¶æ˜¾ç¤ºå½“å‰åˆ†æ”¯"

# æŸ¥çœ‹æ–‡ä»¶å·®å¼‚
agent chat "æŸ¥çœ‹å½“å‰æœ‰å“ªäº›æ–‡ä»¶è¢«ä¿®æ”¹äº†"

# å¤æ‚æ“ä½œ
agent chat "å¸®æˆ‘æŸ¥çœ‹ä»“åº“çŠ¶æ€ï¼Œå¦‚æœæœ‰æœªæš‚å­˜çš„æ–‡ä»¶å°±æ·»åŠ åˆ°æš‚å­˜åŒº"
```

## å®‰å…¨è€ƒè™‘

- æ‰€æœ‰ Git å·¥å…·éƒ½ä¼šéªŒè¯æ–‡ä»¶è·¯å¾„çš„å®‰å…¨æ€§ï¼Œé˜²æ­¢è·¯å¾„éå†æ”»å‡»
- ä¸æ”¯æŒå±é™©çš„ Git æ“ä½œï¼ˆå¦‚ `git reset --hard`ï¼‰
- äº¤äº’å¼å‘½ä»¤åœ¨è‡ªåŠ¨åŒ–ç¯å¢ƒä¸­è¢«ç¦ç”¨
- æ‰€æœ‰å‘½ä»¤éƒ½æœ‰è¶…æ—¶é™åˆ¶ï¼Œé˜²æ­¢é•¿æ—¶é—´é˜»å¡

## é”™è¯¯å¤„ç†

å½“ Git å·¥å…·æ‰§è¡Œå¤±è´¥æ—¶ï¼Œä¼šè¿”å›è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯ï¼š

```json
{
  "success": false,
  "error": "Git status failed: fatal: not a git repository",
  "data": null
}
```

å¸¸è§é”™è¯¯æƒ…å†µï¼š
- ä¸æ˜¯ Git ä»“åº“
- æƒé™ä¸è¶³
- ç½‘ç»œè¿æ¥é—®é¢˜ï¼ˆæ¶‰åŠè¿œç¨‹æ“ä½œæ—¶ï¼‰
- åˆ†æ”¯ä¸å­˜åœ¨
- æ–‡ä»¶è·¯å¾„ä¸å®‰å…¨

## æ‰©å±•æ€§

Git å·¥å…·é›†åˆé‡‡ç”¨æ¨¡å—åŒ–è®¾è®¡ï¼Œæœªæ¥å¯ä»¥è½»æ¾æ·»åŠ æ›´å¤š Git åŠŸèƒ½ï¼š
- `git_push` - æ¨é€åˆ°è¿œç¨‹ä»“åº“
- `git_pull` - ä»è¿œç¨‹ä»“åº“æ‹‰å–
- `git_clone` - å…‹éš†ä»“åº“
- `git_merge` - åˆå¹¶åˆ†æ”¯
- `git_rebase` - å˜åŸºæ“ä½œ
- `git_stash` - æš‚å­˜å·¥ä½œåŒº
- `git_tag` - æ ‡ç­¾ç®¡ç† 